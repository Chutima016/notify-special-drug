<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>Pharmacy SRTH Dev.</title>
  </head>
  <body>
    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script> 
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

  <div class="alert alert-primary" role="alert">
  <center>Loading...</center>
</div>
    
    <script>
  window.onload = function(e) {
  liff.init({liffId:"2007156851-DAak0pLk"}, function() {
    liff.ready.then(() => {
     if (liff.isLoggedIn()) {
       var link = getParameterByName("show");

              
       if(link == "appsheet"){
        var A = getParameterByName("A")//ภาพยา
        var B = getParameterByName("B")//ชื่อผู้ป่วย
        var C = getParameterByName("C")//ชื่อยา
        var D = getParameterByName("D")//ชื่อแพทย์
        var E = getParameterByName("E")//จำนวนอนุมัติ
        var Msg = [
     
          {
  "type": "flex",
  "altText": "แจ้งบันทึกฉบับใหม่",
  "contents":
          
           {
  "type": "bubble",
  "hero": {
    "type": "image",
    "url": ""+A,
    "size": "full",
    "aspectRatio": "20:13",
    "aspectMode": "fit",
    "action": {
      "type": "uri",
      "uri": "https://line.me/"
    }
  },
  "body": {
    "type": "box",
    "layout": "vertical",
    "contents": [
      {
        "type": "text",
        "text": "แจ้งบันทึกข้อความฉบับใหม่",
        "weight": "bold",
        "size": "xl"
      },
      {
        "type": "box",
        "layout": "vertical",
        "margin": "lg",
        "spacing": "sm",
        "contents": [
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อผู้ป่วย",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+B,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อยา",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+C,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อแพทย์",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+D,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "contents": [
              {
                "type": "text",
                "text": "อนุมัติ",
                "weight": "bold",
                "size": "md",
                "flex": 2
              },
              {
                "type": "text",
                "text": ""+E,
                "flex": 5,
                "size": "md",
                "color": "#666666",
                "wrap": true
              }
            ]
          }
        ]
      }
    ]
  },
  "footer": {
    "type": "box",
    "layout": "vertical",
    "spacing": "sm",
    "contents": [
      {
        "type": "button",
        "style": "link",
        "height": "sm",
        "action": {
          "type": "uri",
          "label": "คลิกดูรายละเอียด",
          "uri": "https://www.appsheet.com/start/9363f669-5387-4062-9e50-110cb3804314"
        }
      },
      {
        "type": "box",
        "layout": "vertical",
        "contents": [],
        "margin": "sm"
      }
    ],
    "flex": 0
  }
}
            
         
            
          }
       
        ]
        
        ShareTargetPicker(Msg)
        }

       
       
       
       
       
       if(link == "inv"){
        var A = getParameterByName("A")//ภาพยา
        var B = getParameterByName("B")//ชื่อผู้ป่วย
        var C = getParameterByName("C")//ชื่อยา
        var D = getParameterByName("D")//ห้องยาที่เบิก
        var E = getParameterByName("E")//จำนวนเบิก
        var Msg = [
       
     
          {
  "type": "flex",
  "altText": "แจ้งเบิกยาจากคลังยา",
  "contents":
          
           {
  "type": "bubble",
  "hero": {
    "type": "image",
    "url": ""+A,
    "size": "full",
    "aspectRatio": "20:13",
    "aspectMode": "fit",
    "action": {
      "type": "uri",
      "uri": "https://line.me/"
    }
  },
  "body": {
    "type": "box",
    "layout": "vertical",
    "contents": [
      {
        "type": "text",
        "text": "แจ้งเบิกยาจากคลังยา",
        "weight": "bold",
        "size": "xl"
      },
      {
        "type": "box",
        "layout": "vertical",
        "margin": "lg",
        "spacing": "sm",
        "contents": [
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อผู้ป่วย",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+B,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อยา",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+C,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ห้องยา",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+D,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "contents": [
              {
                "type": "text",
                "text": "จำนวน",
                "weight": "bold",
                "size": "md",
                "flex": 2
              },
              {
                "type": "text",
                "text": ""+E,
                "flex": 5,
                "size": "md",
                "color": "#666666",
                "wrap": true
              }
            ]
          }
        ]
      }
    ]
  },
  "footer": {
    "type": "box",
    "layout": "vertical",
    "spacing": "sm",
    "contents": [
      {
        "type": "button",
        "style": "link",
        "height": "sm",
        "action": {
          "type": "uri",
          "label": "คลิกดูรายละเอียด",
          "uri": "https://www.appsheet.com/start/9363f669-5387-4062-9e50-110cb3804314"
        }
      },
      {
        "type": "box",
        "layout": "vertical",
        "contents": [],
        "margin": "sm"
      }
    ],
    "flex": 0
  }
}
            
         
            
          }
       
        ]
        
        ShareTargetPicker(Msg)
        }


        if(link == "stock"){
        var A = getParameterByName("A")//ภาพยา
        var B = getParameterByName("B")//ชื่อผู้ป่วย
        var C = getParameterByName("C")//ชื่อยา
        var D = getParameterByName("D")//ห้องยาที่รับเข้า
        var E = getParameterByName("E")//จำนวนรับเข้า
        var Msg = [
       
     
          {
  "type": "flex",
  "altText": "แจ้งรับยาเข้าสต๊อก",
  "contents":
          
           {
  "type": "bubble",
  "hero": {
    "type": "image",
    "url": ""+A,
    "size": "full",
    "aspectRatio": "20:13",
    "aspectMode": "fit",
    "action": {
      "type": "uri",
      "uri": "https://line.me/"
    }
  },
  "body": {
    "type": "box",
    "layout": "vertical",
    "contents": [
      {
        "type": "text",
        "text": "แจ้งรับยาจากคลังเข้าสต๊อก",
        "weight": "bold",
        "size": "xl"
      },
      {
        "type": "box",
        "layout": "vertical",
        "margin": "lg",
        "spacing": "sm",
        "contents": [
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อผู้ป่วย",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+B,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อยา",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+C,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ห้องยา",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+D,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "contents": [
              {
                "type": "text",
                "text": "จำนวน",
                "weight": "bold",
                "size": "md",
                "flex": 2
              },
              {
                "type": "text",
                "text": ""+E,
                "flex": 5,
                "size": "md",
                "color": "#666666",
                "wrap": true
              }
            ]
          }
        ]
      }
    ]
  },
  "footer": {
    "type": "box",
    "layout": "vertical",
    "spacing": "sm",
    "contents": [
      {
        "type": "button",
        "style": "link",
        "height": "sm",
        "action": {
          "type": "uri",
          "label": "คลิกดูรายละเอียด",
          "uri": "https://www.appsheet.com/start/9902083e-108e-475c-aca9-aca199335e76"
        }
      },
      {
        "type": "box",
        "layout": "vertical",
        "contents": [],
        "margin": "sm"
      }
    ],
    "flex": 0
  }
}
            
         
            
          }
       
        ]
        
        ShareTargetPicker(Msg)
        }

       
        if(link == "dispense"){
        var A = getParameterByName("A")//ภาพยา
        var B = getParameterByName("B")//ชื่อผู้ป่วย
        var C = getParameterByName("C")//ชื่อยา
        var D = getParameterByName("D")//จำนวนจ่าย
        var E = getParameterByName("E")//จำนวนเหลือ
        var Msg = [
       
     
          {
  "type": "flex",
  "altText": "แจ้งจ่ายยาบันทึกพิเศษ",
  "contents":
          
           {
  "type": "bubble",
  "hero": {
    "type": "image",
    "url": ""+A,
    "size": "full",
    "aspectRatio": "20:13",
    "aspectMode": "fit",
    "action": {
      "type": "uri",
      "uri": "https://line.me/"
    }
  },
  "body": {
    "type": "box",
    "layout": "vertical",
    "contents": [
      {
        "type": "text",
        "text": "แจ้งจ่ายยาบันทึกพิเศษ",
        "weight": "bold",
        "size": "xl"
      },
      {
        "type": "box",
        "layout": "vertical",
        "margin": "lg",
        "spacing": "sm",
        "contents": [
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อผู้ป่วย",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+B,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อยา",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+C,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "จ่าย",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+D,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "contents": [
              {
                "type": "text",
                "text": "เหลือ",
                "weight": "bold",
                "size": "md",
                "flex": 2
              },
              {
                "type": "text",
                "text": ""+E,
                "flex": 5,
                "size": "md",
                "color": "#666666",
                "wrap": true
              }
            ]
          }
        ]
      }
    ]
  },
  "footer": {
    "type": "box",
    "layout": "vertical",
    "spacing": "sm",
    "contents": [
      {
        "type": "button",
        "style": "link",
        "height": "sm",
        "action": {
          "type": "uri",
          "label": "คลิกดูรายละเอียด",
          "uri": "https://www.appsheet.com/start/9c851e5f-1dca-410c-b719-538354324c3a"
        }
      },
      {
        "type": "box",
        "layout": "vertical",
        "contents": [],
        "margin": "sm"
      }
    ],
    "flex": 0
  }
}
            
         
            
          }
       
        ]
        
        ShareTargetPicker(Msg)
        }

      
        if(link == "freeout"){
        var A = getParameterByName("A")//ภาพยา
        var B = getParameterByName("B")//ชื่อยา
        var C = getParameterByName("C")//ชื่อผู้ป่วย
        var D = getParameterByName("D")//ตัดออก
        var E = getParameterByName("E")//คงเหลือ
        var Msg = [
       
     
          {
  "type": "flex",
  "altText": "แจ้งจำนวนยาโค้ดฟรีในสต๊อก",
  "contents":
          
           {
  "type": "bubble",
  "hero": {
    "type": "image",
    "url": ""+A,
    "size": "full",
    "aspectRatio": "20:13",
    "aspectMode": "fit",
    "action": {
      "type": "uri",
      "uri": "https://line.me/"
    }
  },
  "body": {
    "type": "box",
    "layout": "vertical",
    "contents": [
      {
        "type": "text",
        "text": "แจ้งตัดสต๊อกยาโค้ดฟรี",
        "weight": "bold",
        "size": "xl"
      },
      {
        "type": "box",
        "layout": "vertical",
        "margin": "lg",
        "spacing": "sm",
        "contents": [
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อยา",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+B,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อผู้ป่วย",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+C,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ตัดออก",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+D,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "contents": [
              {
                "type": "text",
                "text": "คงเหลือ",
                "weight": "bold",
                "size": "md",
                "flex": 2
              },
              {
                "type": "text",
                "text": ""+E,
                "flex": 5,
                "size": "md",
                "color": "#666666",
                "wrap": true
              }
            ]
          }
        ]
      }
    ]
  },
  "footer": {
    "type": "box",
    "layout": "vertical",
    "spacing": "sm",
    "contents": [
      {
        "type": "button",
        "style": "link",
        "height": "sm",
        "action": {
          "type": "uri",
          "label": "คลิกดูรายละเอียด",
          "uri": "https://www.appsheet.com/start/fa536dc8-ab7c-4222-9725-c6ec86189b76"
        }
      },
      {
        "type": "box",
        "layout": "vertical",
        "contents": [],
        "margin": "sm"
      }
    ],
    "flex": 0
  }
}
            
         
            
          }
       
        ]
        
        ShareTargetPicker(Msg)
        }

       
       
        if(link == "freein"){
        var A = getParameterByName("A")//ภาพยา
        var B = getParameterByName("B")//ชื่อยา
        var C = getParameterByName("C")//รับเข้า
        var D = getParameterByName("D")//คงเหลือ        
        var Msg = [
       
     
          {
  "type": "flex",
  "altText": "แจ้งจำนวนยาโค้ดฟรีในสต๊อก",
  "contents":
          
           {
  "type": "bubble",
  "hero": {
    "type": "image",
    "url": ""+A,
    "size": "full",
    "aspectRatio": "20:13",
    "aspectMode": "fit",
    "action": {
      "type": "uri",
      "uri": "https://line.me/"
    }
  },
  "body": {
    "type": "box",
    "layout": "vertical",
    "contents": [
      {
        "type": "text",
        "text": "แจ้งรับยาโค้ดฟรีเข้าสต๊อก",
        "weight": "bold",
        "size": "xl"
      },
      {
        "type": "box",
        "layout": "vertical",
        "margin": "lg",
        "spacing": "sm",
        "contents": [
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "ชื่อยา",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+B,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },
          {
            "type": "box",
            "layout": "baseline",
            "spacing": "sm",
            "contents": [
              {
                "type": "text",
                "text": "รับเข้า",
                "size": "md",
                "flex": 2,
                "weight": "bold"
              },
              {
                "type": "text",
                "text": ""+C,
                "wrap": true,
                "color": "#666666",
                "size": "md",
                "flex": 5
              }
            ]
          },          
          {
            "type": "box",
            "layout": "baseline",
            "contents": [
              {
                "type": "text",
                "text": "คงเหลือ",
                "weight": "bold",
                "size": "md",
                "flex": 2
              },
              {
                "type": "text",
                "text": ""+D,
                "flex": 5,
                "size": "md",
                "color": "#666666",
                "wrap": true
              }
            ]
          }
        ]
      }
    ]
  },
  "footer": {
    "type": "box",
    "layout": "vertical",
    "spacing": "sm",
    "contents": [
      {
        "type": "button",
        "style": "link",
        "height": "sm",
        "action": {
          "type": "uri",
          "label": "คลิกดูรายละเอียด",
          "uri": "https://www.appsheet.com/start/fa536dc8-ab7c-4222-9725-c6ec86189b76"
        }
      },
      {
        "type": "box",
        "layout": "vertical",
        "contents": [],
        "margin": "sm"
      }
    ],
    "flex": 0
  }
}
            
         
            
          }
       
        ]
        
        ShareTargetPicker(Msg)
        }

       
       
       
   } else {
        liff.login();
      }

  
    })
  });
    
    
      function ShareTargetPicker(flex){
 
   liff.shareTargetPicker(flex).then(function () {
            liff.closeWindow();
        });
   

      }
    
    function sendflex(flex){
        
    liff.sendMessages(flex).then(function() {
            liff.closeWindow();
          
        });
        
      }
    
    
    
      function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, '\\$&');
    var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
}
  }
  

    </script>
    
  </body>
</html>



